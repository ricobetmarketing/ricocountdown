<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VIP Day Mission ‚Äî Secret Island Hunt</title>

  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Special+Elite&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#120b07;
      --paper:#f2e3c9;
      --ink:#3d2b1f;
      --accent:#8b0000;
      --gold:#ffd166;
      --emerald:#22c55e;
      --cyan:#22d3ee;
      --muted: rgba(61,43,31,.55);
      --shadow: 0 25px 70px rgba(0,0,0,.65);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:'Special Elite', ui-monospace, monospace;
      background:
        radial-gradient(900px 500px at 50% -10%, rgba(255,209,102,.15), transparent 60%),
        radial-gradient(700px 400px at 15% 20%, rgba(34,211,238,.12), transparent 60%),
        radial-gradient(800px 500px at 85% 70%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(180deg, #0b0604 0%, var(--bg) 55%, #0b0604 100%);
      color:var(--ink);
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:28px 16px 80px;
      overflow-x:hidden;
    }

    /* subtle floating particles */
    .dust{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.22;
      background-image:
        radial-gradient(circle at 10% 10%, rgba(255,255,255,.2) 0 1px, transparent 2px),
        radial-gradient(circle at 40% 30%, rgba(255,255,255,.15) 0 1px, transparent 2px),
        radial-gradient(circle at 70% 60%, rgba(255,255,255,.18) 0 1px, transparent 2px),
        radial-gradient(circle at 20% 80%, rgba(255,255,255,.14) 0 1px, transparent 2px),
        radial-gradient(circle at 90% 20%, rgba(255,255,255,.12) 0 1px, transparent 2px);
      filter: blur(.2px);
      animation: drift 10s linear infinite;
    }
    @keyframes drift{
      0%{ transform:translateY(0); }
      50%{ transform:translateY(10px); }
      100%{ transform:translateY(0); }
    }

    .wrap{
      width:min(980px, 100%);
      display:flex;
      flex-direction:column;
      gap:16px;
      align-items:stretch;
    }

    /* top HUD */
    .hud{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      color:#f6ead7;
      opacity:.95;
    }

    .hud .badge{
      display:flex;
      align-items:center;
      gap:10px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      padding:10px 12px;
      border-radius:14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      backdrop-filter: blur(8px);
    }

    .hud .title{
      font-family:'Cinzel', serif;
      font-weight:700;
      letter-spacing:.8px;
      font-size:16px;
      line-height:1.1;
    }
    .hud .subtitle{
      font-size:12px;
      opacity:.75;
    }

    .xp{
      min-width:320px;
      flex:1;
      max-width:520px;
    }
    .xp-top{
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-size:12px;
      opacity:.9;
      margin-bottom:6px;
    }
    .bar{
      height:12px;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.14);
      border-radius:999px;
      overflow:hidden;
    }
    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(255,209,102,.95), rgba(34,211,238,.85));
      border-radius:999px;
      transition: width .6s ease;
      box-shadow: 0 0 25px rgba(255,209,102,.35);
    }

    .btn{
      border:none;
      cursor:pointer;
      font-family:'Cinzel', serif;
      font-weight:700;
      letter-spacing:.5px;
      border-radius:14px;
      padding:12px 14px;
      color:#0b0604;
      background: linear-gradient(180deg, #ffe8a3, var(--gold));
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      transition: transform .15s ease, filter .15s ease;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); filter:brightness(1.03); }
    .btn:active{ transform: translateY(0px) scale(.99); }

    .btn-ghost{
      background:rgba(255,255,255,.06);
      color:#f6ead7;
      border:1px solid rgba(255,255,255,.14);
      box-shadow:none;
    }
    .btn-ghost:hover{ filter:brightness(1.1); }

    /* parchment card */
    .parchment{
      position:relative;
      background: var(--paper);
      border:2px solid #5a4b3f;
      border-radius:22px;
      padding:26px 18px;
      box-shadow: inset 0 0 110px rgba(0,0,0,.18), var(--shadow);
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='6' viewBox='0 0 6 6'%3E%3Cpath fill='%233d2b1f' fill-opacity='0.06' d='M1 5h1v1H1V5zm3-3h1v1H4V2zM0 1h1v1H0V1z'%3E%3C/path%3E%3C/svg%3E");
      overflow:hidden;
    }
    .parchment:before{
      content:"";
      position:absolute;
      inset:-40px;
      background:
        radial-gradient(closest-side at 15% 10%, rgba(139,0,0,.10), transparent 70%),
        radial-gradient(closest-side at 85% 20%, rgba(34,211,238,.10), transparent 75%),
        radial-gradient(closest-side at 30% 90%, rgba(255,209,102,.10), transparent 70%);
      filter: blur(0px);
      pointer-events:none;
      transform: rotate(-2deg);
    }

    .head{
      position:relative;
      padding:8px 18px 18px;
    }
    .head h1{
      margin:0 0 8px 0;
      font-family:'Cinzel', serif;
      text-align:center;
      font-size: clamp(1.4rem, 3.2vw, 2.25rem);
      letter-spacing:1px;
      border-bottom:2px solid var(--ink);
      padding-bottom:10px;
      position:relative;
      z-index:1;
    }
    .head p{
      margin:0;
      text-align:center;
      color:var(--muted);
      font-size: .95rem;
      position:relative;
      z-index:1;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.3fr .9fr;
      gap:16px;
      padding: 6px 14px 18px;
      position:relative;
      z-index:1;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns:1fr; }
      .xp{ min-width: 220px; }
    }

    /* map */
    .map{
      border:3px solid var(--ink);
      border-radius:18px;
      overflow:hidden;
      background:#e4d5b7;
      position:relative;
      height: 380px;
      box-shadow: inset 0 0 55px rgba(0,0,0,.14);
    }
    .map:after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(500px 200px at 20% 15%, rgba(0,0,0,.05), transparent 60%),
        radial-gradient(500px 220px at 80% 85%, rgba(0,0,0,.06), transparent 55%);
      pointer-events:none;
    }

    .map .hidden-clue{
      position:absolute;
      top:10px; right:14px;
      font-size:12px;
      color: rgba(0,0,0,0.045);
      user-select:all;
      z-index:3;
    }

    .map-svg{ width:100%; height:100%; display:block; }

    /* interactive hotspots */
    .hotspot{
      position:absolute;
      width:54px; height:54px;
      border-radius:50%;
      border:2px dashed rgba(139,0,0,.55);
      background: rgba(255,255,255,.10);
      box-shadow: 0 0 0 0 rgba(139,0,0,.35);
      cursor:pointer;
      display:grid;
      place-items:center;
      z-index:6;
      transition: transform .15s ease, filter .15s ease, border-color .2s ease;
      backdrop-filter: blur(2px);
      animation: ping 2.2s infinite ease-in-out;
    }
    .hotspot:hover{ transform: scale(1.06); filter: brightness(1.05); border-color: rgba(139,0,0,.8); }
    .hotspot:active{ transform: scale(0.98); }
    .hotspot span{
      font-family:'Cinzel', serif;
      font-weight:700;
      color: var(--accent);
      text-shadow: 0 0 12px rgba(139,0,0,.25);
      user-select:none;
    }
    @keyframes ping{
      0%{ box-shadow: 0 0 0 0 rgba(139,0,0,.25); }
      60%{ box-shadow: 0 0 0 14px rgba(139,0,0,0); }
      100%{ box-shadow: 0 0 0 0 rgba(139,0,0,0); }
    }

    .xmark{
      border-style: solid;
      border-color: rgba(139,0,0,.55);
      background: rgba(139,0,0,.08);
    }

    .tooltip{
      position:absolute;
      left:50%;
      top:-10px;
      transform: translate(-50%, -100%);
      background: rgba(17, 24, 39, .92);
      color:#fff;
      padding:8px 10px;
      border-radius:12px;
      font-size:12px;
      white-space:nowrap;
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
      border:1px solid rgba(255,255,255,.14);
    }
    .hotspot:hover .tooltip{
      opacity:1;
      transform: translate(-50%, -110%);
    }

    /* right panel */
    .panel{
      border:2px dashed rgba(61,43,31,.35);
      border-radius:18px;
      padding:14px 14px 12px;
      background: rgba(0,0,0,.03);
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height: 380px;
    }

    .panel h2{
      margin:0;
      font-family:'Cinzel', serif;
      font-size: 1.05rem;
      letter-spacing:.6px;
      color: var(--accent);
    }

    .steps{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:4px;
    }

    .step{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(61,43,31,.25);
      background: rgba(255,255,255,.35);
      transition: transform .15s ease, filter .15s ease;
    }
    .step.done{
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.10);
    }
    .step .dot{
      width:28px; height:28px;
      border-radius:10px;
      display:grid; place-items:center;
      font-weight:800;
      background: rgba(61,43,31,.10);
      border:1px solid rgba(61,43,31,.20);
      user-select:none;
    }
    .step.done .dot{
      background: rgba(34,197,94,.18);
      border-color: rgba(34,197,94,.35);
    }
    .step .meta{
      flex:1;
      font-size: .9rem;
      line-height:1.25;
    }
    .step .meta strong{
      display:block;
      margin-bottom:4px;
      font-family:'Cinzel', serif;
      letter-spacing:.4px;
    }
    .step small{
      color: rgba(61,43,31,.70);
    }

    .panel .mini{
      display:flex;
      gap:10px;
      margin-top:auto;
      flex-wrap:wrap;
    }

    .hintbox{
      display:none;
      border-radius:14px;
      padding:10px 12px;
      border:1px solid rgba(34,211,238,.35);
      background: rgba(34,211,238,.10);
      font-size:.9rem;
      color: rgba(61,43,31,.9);
    }
    .hintbox b{
      font-family:'Cinzel', serif;
    }

    /* unlock area */
    .unlock{
      border-top:1px solid rgba(0,0,0,.12);
      padding:16px 18px 8px;
      position:relative;
      z-index:1;
    }
    .unlock .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      align-items:center;
      margin-top:10px;
    }
    input{
      padding:12px 12px;
      width:min(320px, 90vw);
      border:1px solid var(--ink);
      border-radius:14px;
      background: transparent;
      font-family:'Special Elite', ui-monospace, monospace;
      font-size: 1.05rem;
      text-align:center;
      outline:none;
    }
    input:focus{
      box-shadow: 0 0 0 4px rgba(255,209,102,.25);
      border-color: rgba(139,0,0,.45);
    }

    .micro{
      font-size: 4px;
      opacity: 0.05;
      margin-top: 10px;
      text-align:center;
      user-select:text;
    }

    /* overlay / modals */
    .overlay{
      display:none;
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.92);
      z-index:100;
      align-items:center;
      justify-content:center;
      padding:22px 14px;
    }
    .modal{
      width:min(740px, 100%);
      border-radius:22px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 30px 100px rgba(0,0,0,.6);
      backdrop-filter: blur(10px);
      color:#f6ead7;
      overflow:hidden;
    }
    .modal header{
      padding:18px 18px 12px;
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .modal header h3{
      margin:0;
      font-family:'Cinzel', serif;
      letter-spacing:1px;
      font-size: 1.3rem;
    }
    .modal header p{
      margin:8px 0 0;
      opacity:.85;
      font-size:.95rem;
      line-height:1.35;
    }
    .modal .content{
      padding:16px 18px;
      display:grid;
      gap:10px;
    }
    .modal .content .card{
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
    }
    .modal .content .card b{
      color: var(--gold);
      font-family:'Cinzel', serif;
      letter-spacing:.6px;
    }
    .modal footer{
      padding:14px 18px;
      display:flex;
      justify-content:flex-end;
      gap:10px;
      border-top:1px solid rgba(255,255,255,.12);
      flex-wrap:wrap;
    }

    /* reward overlay */
    #rewardOverlay .modal{
      width:min(780px, 100%);
      text-align:center;
    }
    .chest{
      margin: 14px auto 6px;
      width:140px;
      height:110px;
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,209,102,.98), rgba(255,209,102,.65));
      box-shadow: 0 18px 50px rgba(0,0,0,.45);
      position:relative;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.2);
    }
    .chest:before{
      content:"";
      position:absolute;
      left:0; right:0;
      top:45%;
      height:12px;
      background: rgba(0,0,0,.18);
    }
    .chest:after{
      content:"";
      position:absolute;
      width:42px; height:42px;
      border-radius:14px;
      left:50%; top:50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,.18);
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.18);
    }
    .burst{
      position:absolute;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(circle at 50% 60%, rgba(255,209,102,.32), transparent 45%),
        radial-gradient(circle at 20% 20%, rgba(34,211,238,.25), transparent 40%),
        radial-gradient(circle at 80% 30%, rgba(34,197,94,.22), transparent 40%);
      opacity:0;
      animation: pop .9s ease forwards;
    }
    @keyframes pop{
      0%{ opacity:0; transform: scale(.98); }
      35%{ opacity:1; transform: scale(1); }
      100%{ opacity:0.85; transform: scale(1); }
    }

    .codebox{
      display:inline-block;
      margin-top: 10px;
      padding: 14px 18px;
      border-radius:18px;
      border: 2px dashed rgba(255,209,102,.95);
      background: rgba(0,0,0,.25);
      font-size: clamp(1.2rem, 3.5vw, 2rem);
      letter-spacing:1px;
      color: #ffe8a3;
      user-select: all;
    }
    .rewardText{
      margin: 8px 0 0;
      font-size: 1.1rem;
      opacity:.95;
    }

    /* toast */
    .toast{
      position:fixed;
      left:50%;
      bottom:22px;
      transform: translateX(-50%);
      background: rgba(17,24,39,.92);
      color:#fff;
      border:1px solid rgba(255,255,255,.14);
      border-radius:14px;
      padding:10px 12px;
      font-size: 13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .25s ease, transform .25s ease;
      z-index:150;
      max-width: 92vw;
      text-align:center;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-4px);
    }
  </style>
</head>

<body>
  <div class="dust"></div>

  <!-- TOP HUD -->
  <div class="wrap">
    <div class="hud">
      <div class="badge">
        <div>
          <div class="title">VIP Day Treasure Hunt</div>
          <div class="subtitle">15th ‚Äî Find codes. Unlock rewards.</div>
        </div>
      </div>

      <div class="badge xp" aria-live="polite">
        <div style="width:100%">
          <div class="xp-top">
            <div>Level <b id="lvl">1</b> ‚Ä¢ XP <b id="xpTxt">0</b>/<b id="xpMaxTxt">100</b></div>
            <div>Steps <b id="stepsDone">0</b>/<b id="stepsTotal">4</b></div>
          </div>
          <div class="bar"><i id="xpBar"></i></div>
        </div>
      </div>

      <div class="badge">
        <button class="btn btn-ghost" id="btnBrief">Mission Brief</button>
        <button class="btn" id="btnReset">Reset</button>
      </div>
    </div>

    <!-- MAIN PARCHMENT -->
    <section class="parchment">
      <div class="head">
        <h1>Mission: The Secret Island Hunt</h1>
        <p>Explore the map, collect clues, then enter the voucher code to unlock your treasure.</p>
      </div>

      <div class="grid">
        <!-- MAP -->
        <div class="map" id="map">
          <!-- almost invisible code -->
          <div class="hidden-clue">MAP_CODE_ISLAND77</div>

          <svg class="map-svg" viewBox="0 0 800 380" xmlns="http://www.w3.org/2000/svg">
            <!-- ocean lines -->
            <path d="M0 60 Q 70 50 140 60 T 280 60 T 420 60" stroke="#3d2b1f" stroke-opacity="0.10" fill="none"/>
            <path d="M380 330 Q 470 320 560 330 T 740 330" stroke="#3d2b1f" stroke-opacity="0.10" fill="none"/>

            <!-- islands -->
            <path d="M110 170 Q 160 90 270 130 T 335 215 Q 290 320 170 270 Z" fill="#d2bc96" stroke="#3d2b1f" stroke-width="2"/>
            <path d="M540 110 Q 660 55 735 165 T 615 280 Q 500 220 540 110 Z" fill="#d2bc96" stroke="#3d2b1f" stroke-width="2"/>

            <!-- route -->
            <path d="M240 205 C 320 270, 460 110, 600 200" stroke="#8b0000" stroke-width="2.3" stroke-dasharray="8,5" fill="none" opacity="0.6"/>

            <!-- compass -->
            <g transform="translate(720, 70) scale(0.62)">
              <circle cx="0" cy="0" r="52" stroke="#3d2b1f" fill="none"/>
              <path d="M0 -62 L 0 62 M -62 0 L 62 0" stroke="#3d2b1f"/>
              <text x="-8" y="-70" font-family="Cinzel" font-size="24">N</text>
            </g>

            <text x="145" y="205" font-family="Special Elite" font-size="14" opacity="0.55">Monkey Mountain</text>
            <text x="575" y="175" font-family="Special Elite" font-size="14" opacity="0.55">Danger Zone</text>
            <text x="310" y="55" font-family="Special Elite" font-size="18" opacity="0.26" letter-spacing="5">SILVER OCEAN</text>

            <!-- small "ink stain" shapes -->
            <circle cx="70" cy="290" r="18" fill="#3d2b1f" opacity="0.06"/>
            <circle cx="92" cy="300" r="10" fill="#3d2b1f" opacity="0.04"/>
            <circle cx="650" cy="320" r="16" fill="#3d2b1f" opacity="0.05"/>
          </svg>

          <!-- HOTSPOTS -->
          <!-- X: center -->
          <div class="hotspot xmark" style="left: 48%; top: 50%;" data-step="0" data-code="MAP_CODE_ISLAND77">
            <div class="tooltip">Hotspot: X Mark ‚Ä¢ Tap to collect</div>
            <span>X</span>
          </div>

          <!-- Cave -->
          <div class="hotspot" style="left: 22%; top: 56%;" data-step="1" data-code="GHOST_VAULT_7">
            <div class="tooltip">Whispering Cave ‚Ä¢ Hidden ink</div>
            <span>‚ú¶</span>
          </div>

          <!-- Compass -->
          <div class="hotspot" style="left: 84%; top: 18%;" data-step="2" data-code="COMMIT_RECOVER">
            <div class="tooltip">Compass Node ‚Ä¢ Time travel</div>
            <span>‚ßó</span>
          </div>

          <!-- Skulls -->
          <div class="hotspot" style="left: 72%; top: 62%;" data-step="3" data-code="HIDDEN_VAULT">
            <div class="tooltip">Skull Bay ‚Ä¢ Private access</div>
            <span>‚ò†</span>
          </div>
        </div>

        <!-- SIDE PANEL -->
        <aside class="panel">
          <h2>Objective Tracker</h2>

          <div class="steps" id="steps">
            <div class="step" data-step="0">
              <div class="dot">1</div>
              <div class="meta">
                <strong>Find the X Mark</strong>
                <small>Tap the glowing hotspot on the map.</small>
              </div>
            </div>
            <div class="step" data-step="1">
              <div class="dot">2</div>
              <div class="meta">
                <strong>Reveal Invisible Ink</strong>
                <small>Some clues hide in ‚Äúempty‚Äù spaces.</small>
              </div>
            </div>
            <div class="step" data-step="2">
              <div class="dot">3</div>
              <div class="meta">
                <strong>Recover Lost Code</strong>
                <small>Think: history, commits, time travel.</small>
              </div>
            </div>
            <div class="step" data-step="3">
              <div class="dot">4</div>
              <div class="meta">
                <strong>Locate Private Access</strong>
                <small>Secrets are buried in config-like places.</small>
              </div>
            </div>
          </div>

          <div class="hintbox" id="hintbox"></div>

          <div class="mini">
            <button class="btn btn-ghost" id="btnHint">Use Hint (<span id="hintLeft">2</span>)</button>
            <button class="btn btn-ghost" id="btnCopyFound">Copy Found Codes</button>
          </div>

          <div style="font-size:12px;color:rgba(61,43,31,.6);margin-top:2px;">
            Tip: Tap hotspots to ‚Äúcollect‚Äù codes. Then enter one below.
          </div>
        </aside>
      </div>

      <!-- UNLOCK -->
      <div class="unlock">
        <div style="text-align:center; font-family:'Cinzel', serif; font-weight:700; letter-spacing:.6px;">
          FOUND A CODE? ENTER IT TO UNLOCK YOUR TREASURE
        </div>

        <div class="row">
          <input id="inputBox" type="text" placeholder="Ex: MAP_CODE_ISLAND77" autocomplete="off" />
          <button class="btn" id="btnDecrypt">DECRYPT TREASURE</button>
        </div>

        <div class="micro">TINY_VOUCHER_2026</div>
      </div>
    </section>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast"></div>

  <!-- BRIEFING OVERLAY -->
  <div class="overlay" id="briefOverlay">
    <div class="modal">
      <header>
        <h3>üìú Mission Briefing</h3>
        <p>
          Welcome, VIP Explorer. Your task is to locate hidden voucher codes across the island map.
          Collect clues, enter the code, and unlock your reward chest.
        </p>
      </header>

      <div class="content">
        <div class="card"><b>How to play</b><br>Tap the glowing hotspots on the map to collect codes. Enter a code to unlock a reward.</div>
        <div class="card"><b>VIP advantage</b><br>You have limited <b>Hints</b>. Use them wisely to speed-run the treasure.</div>
        <div class="card"><b>Pro tip</b><br>Some codes are ‚Äúghost ink‚Äù ‚Äî highlight, click around, and inspect carefully.</div>
      </div>

      <footer>
        <button class="btn btn-ghost" id="btnCloseBrief">Not now</button>
        <button class="btn" id="btnStart">Start Mission</button>
      </footer>
    </div>
  </div>

  <!-- REWARD OVERLAY -->
  <div class="overlay" id="rewardOverlay">
    <div class="modal" style="position:relative;">
      <div class="burst"></div>
      <header style="text-align:center;">
        <h3>üí∞ Reward Unlocked üí∞</h3>
        <p style="margin:10px 0 0; opacity:.9;">You cracked the map. Claim your treasure.</p>
      </header>

      <div class="content" style="text-align:center;">
        <div class="chest" aria-hidden="true"></div>
        <div class="rewardText" id="rewardInfo"></div>
        <div class="codebox" id="displayCode"></div>
        <div style="opacity:.75; font-size:12px; margin-top:8px;">
          (Tap the code to copy)
        </div>
      </div>

      <footer style="justify-content:center;">
        <button class="btn btn-ghost" id="btnPlayAgain">Play Again</button>
        <button class="btn" id="btnClaim">CLAIM & SHOP</button>
      </footer>
    </div>
  </div>

  <script>
    /***********************
     * CONFIG ‚Äî EDIT THIS
     ***********************/
    const REWARDS = {
      "MAP_CODE_ISLAND77": "RM50 CASH VOUCHER",
      "GHOST_VAULT_7": "30% OFF TOTAL BILL",
      "TINY_VOUCHER_2026": "FREE SHIPPING NO MIN SPEND",
      "COMMIT_RECOVER": "VIP EXCLUSIVE SURPRISE GIFT",
      "HIDDEN_VAULT": "BUY 1 FREE 1 ACCESS"
    };

    // Optional: what each hotspot "gives"
    const STEPS = [
      { code:"MAP_CODE_ISLAND77", label:"X Mark collected (+25 XP)" },
      { code:"GHOST_VAULT_7",     label:"Invisible ink revealed (+25 XP)" },
      { code:"COMMIT_RECOVER",    label:"Lost code recovered (+25 XP)" },
      { code:"HIDDEN_VAULT",      label:"Private access located (+25 XP)" }
    ];

    /***********************
     * GAME STATE
     ***********************/
    const state = {
      xp: 0,
      lvl: 1,
      xpMax: 100,
      hintsLeft: 2,
      stepsDone: new Set(),
      foundCodes: new Set()
    };

    const el = (id) => document.getElementById(id);

    function toast(msg){
      const t = el("toast");
      t.textContent = msg;
      t.classList.add("show");
      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(()=> t.classList.remove("show"), 1800);
    }

    function normalizeCode(s){
      return String(s || "").trim().toUpperCase();
    }

    function addXP(amount){
      state.xp = Math.max(0, state.xp + amount);
      while(state.xp >= state.xpMax){
        state.xp -= state.xpMax;
        state.lvl += 1;
        state.xpMax = Math.round(state.xpMax * 1.15);
        toast(`Level up! You are now Level ${state.lvl} ‚ú®`);
      }
      renderHUD();
    }

    function renderHUD(){
      el("lvl").textContent = state.lvl;
      el("xpTxt").textContent = state.xp;
      el("xpMaxTxt").textContent = state.xpMax;
      el("stepsDone").textContent = state.stepsDone.size;
      el("stepsTotal").textContent = STEPS.length;
      el("xpBar").style.width = Math.min(100, (state.xp/state.xpMax)*100) + "%";
      el("hintLeft").textContent = state.hintsLeft;
    }

    function markStepDone(stepIndex){
      state.stepsDone.add(stepIndex);
      const node = document.querySelector(`.step[data-step="${stepIndex}"]`);
      if(node) node.classList.add("done");
      renderHUD();
    }

    function collectCode(stepIndex, code){
      const c = normalizeCode(code);
      if(!c) return;

      const firstTime = !state.foundCodes.has(c);
      state.foundCodes.add(c);

      if(firstTime){
        markStepDone(stepIndex);
        addXP(25);
        toast(`Collected: ${c}`);
        // auto-fill input for convenience (feels satisfying)
        el("inputBox").value = c;
      } else {
        toast(`Already collected: ${c}`);
      }
    }

    function openBrief(){
      el("briefOverlay").style.display = "flex";
    }
    function closeBrief(){
      el("briefOverlay").style.display = "none";
    }
    function openReward(code, rewardText){
      el("rewardInfo").textContent = "Voucher found: " + rewardText;
      el("displayCode").textContent = code;
      el("rewardOverlay").style.display = "flex";
      // little XP bonus for successful redeem
      addXP(10);
      confettiBurst();
    }
    function closeReward(){
      el("rewardOverlay").style.display = "none";
    }

    function resetGame(){
      state.xp = 0;
      state.lvl = 1;
      state.xpMax = 100;
      state.hintsLeft = 2;
      state.stepsDone = new Set();
      state.foundCodes = new Set();
      document.querySelectorAll(".step").forEach(s => s.classList.remove("done"));
      el("hintbox").style.display = "none";
      el("hintbox").textContent = "";
      el("inputBox").value = "";
      renderHUD();
      toast("Mission reset.");
    }

    function checkCode(){
      const raw = el("inputBox").value;
      const val = normalizeCode(raw);

      if(!val){
        toast("Enter a code first.");
        return;
      }

      if(REWARDS[val]){
        openReward(val, REWARDS[val]);
      } else {
        toast("Access denied ‚Äî code not recognized.");
        // small penalty to make it gamey (optional)
        addXP(0);
      }
    }

    function showHint(){
      if(state.hintsLeft <= 0){
        toast("No hints left.");
        return;
      }

      // Find the next incomplete step and give a gentle hint
      let next = -1;
      for(let i=0;i<STEPS.length;i++){
        if(!state.stepsDone.has(i)){ next = i; break; }
      }

      state.hintsLeft -= 1;
      renderHUD();

      const box = el("hintbox");
      box.style.display = "block";

      if(next === -1){
        box.innerHTML = "<b>VIP Intel:</b> You already cleared all steps. Try entering any collected code.";
        toast("Hint used.");
        return;
      }

      const hints = [
        "<b>VIP Intel:</b> The biggest glow is the easiest win. Start at the center.",
        "<b>VIP Intel:</b> Some clues are nearly invisible. Try selecting text on the parchment.",
        "<b>VIP Intel:</b> ‚ÄúTime travel‚Äù suggests old versions. Think: commit history.",
        "<b>VIP Intel:</b> Look for ‚Äúprivate access‚Äù patterns‚Äîlike hidden keys in config files."
      ];

      box.innerHTML = hints[next] || "<b>VIP Intel:</b> Look around the map carefully.";
      toast("Hint used.");
    }

    async function copyFoundCodes(){
      const list = [...state.foundCodes].sort().join("\n");
      if(!list){
        toast("No codes collected yet.");
        return;
      }
      try{
        await navigator.clipboard.writeText(list);
        toast("Copied found codes.");
      } catch {
        // fallback
        const ta = document.createElement("textarea");
        ta.value = list;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        toast("Copied found codes.");
      }
    }

    async function copyOneCode(code){
      try{
        await navigator.clipboard.writeText(code);
        toast("Code copied!");
      } catch {
        toast("Copy not supported here.");
      }
    }

    // Simple confetti burst (no libs)
    function confettiBurst(){
      const count = 34;
      for(let i=0;i<count;i++){
        const p = document.createElement("div");
        p.style.position = "fixed";
        p.style.left = (window.innerWidth/2 + (Math.random()*240-120)) + "px";
        p.style.top = (window.innerHeight/2 + (Math.random()*80-40)) + "px";
        p.style.width = (6 + Math.random()*6) + "px";
        p.style.height = (10 + Math.random()*10) + "px";
        p.style.background = `hsl(${Math.floor(Math.random()*360)}, 85%, 60%)`;
        p.style.borderRadius = "4px";
        p.style.zIndex = 9999;
        p.style.opacity = "0.95";
        p.style.transform = `rotate(${Math.random()*360}deg)`;
        p.style.boxShadow = "0 12px 35px rgba(0,0,0,.35)";
        document.body.appendChild(p);

        const dx = (Math.random()*2-1) * 360;
        const dy = (Math.random()*-1) * 420 - 120;
        const dur = 900 + Math.random()*700;

        const start = performance.now();
        (function anim(t){
          const k = Math.min(1, (t-start)/dur);
          const ease = 1 - Math.pow(1-k, 3);
          p.style.transform = `translate(${dx*ease}px, ${dy*ease}px) rotate(${(360*ease)}deg)`;
          p.style.opacity = String(0.95 - k*0.95);
          if(k < 1) requestAnimationFrame(anim);
          else p.remove();
        })(start);
      }
    }

    /***********************
     * WIRE UI
     ***********************/
    document.querySelectorAll(".hotspot").forEach(h => {
      h.addEventListener("click", () => {
        const step = Number(h.getAttribute("data-step"));
        const code = h.getAttribute("data-code");
        collectCode(step, code);
      });
    });

    el("btnDecrypt").addEventListener("click", checkCode);
    el("inputBox").addEventListener("keydown", (e) => {
      if(e.key === "Enter") checkCode();
    });

    el("btnHint").addEventListener("click", showHint);
    el("btnCopyFound").addEventListener("click", copyFoundCodes);

    el("btnBrief").addEventListener("click", openBrief);
    el("btnCloseBrief").addEventListener("click", closeBrief);
    el("btnStart").addEventListener("click", () => { closeBrief(); toast("Mission started. Tap hotspots!"); });

    el("btnReset").addEventListener("click", resetGame);

    el("btnPlayAgain").addEventListener("click", () => { closeReward(); });
    el("btnClaim").addEventListener("click", () => {
      // Replace this with your redeem/shop link if you want:
      // window.location.href = "https://your-site.com/redeem";
      closeReward();
      toast("Claim recorded. See you at the shop!");
    });

    el("displayCode").addEventListener("click", () => copyOneCode(el("displayCode").textContent));

    // Open briefing on first load for VIP vibe
    renderHUD();
    openBrief();
  </script>
</body>
</html>
